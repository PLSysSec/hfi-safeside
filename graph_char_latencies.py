#!/usr/bin/env python3

import matplotlib.pyplot as plt
import numpy as np

x = np.arange(1,257)
# Put character latencies here
# Get the character latencies by running the Spectre pht_sa and pht_sa_hfi POCs
threshold = 18
original_latencies = [178, 190, 176, 163, 179, 163, 172, 174, 185, 168, 170, 169, 179, 174, 66, 181, 180, 175, 170, 171, 182, 180, 169, 172, 174, 184, 169, 174, 170, 183, 62, 162, 164, 161, 173, 170, 172, 169, 181, 165, 78, 178, 171, 174, 171, 167, 172, 172, 163, 168, 179, 173, 179, 160, 175, 167, 63, 171, 170, 175, 175, 180, 175, 175, 190, 168, 166, 173, 173, 67, 176, 169, 165, 18, 171, 167, 169, 187, 201, 164, 179, 167, 172, 172, 171, 178, 158, 177, 174, 162, 172, 168, 170, 186, 174, 67, 182, 174, 183, 179, 160, 162, 165, 166, 170, 183, 188, 165, 134, 166, 161, 55, 158, 171, 163, 160, 156, 157, 174, 164, 169, 162, 174, 152, 178, 159, 162, 182, 176, 170, 167, 169, 174, 180, 159, 182, 171, 179, 172, 179, 177, 165, 175, 165, 169, 179, 175, 181, 177, 168, 66, 177, 172, 179, 176, 179, 177, 163, 188, 166, 175, 174, 169, 176, 177, 172, 178, 164, 167, 177, 172, 174, 178, 175, 188, 167, 64, 169, 170, 178, 178, 184, 182, 168, 166, 172, 173, 171, 182, 67, 169, 164, 63, 168, 175, 189, 186, 173, 171, 170, 184, 180, 174, 180, 174, 63, 166, 169, 178, 165, 180, 169, 182, 178, 178, 172, 182, 172, 177, 172, 168, 169, 172, 174, 180, 167, 178, 173, 172, 184, 180, 66, 176, 172, 173, 181, 166, 176, 167, 170, 175, 178, 177, 167, 181, 163, 176, 178, 174, 176, 178, 179, 173, 172, 162, 175]
hfi_latencies = [178, 183, 174, 173, 173, 180, 179, 178, 174, 174, 175, 168, 158, 179, 174, 167, 169, 172, 179, 174, 177, 173, 178, 172, 174, 185, 177, 181, 177, 167, 167, 168, 162, 172, 160, 186, 169, 61, 181, 161, 178, 169, 167, 189, 154, 167, 168, 163, 186, 167, 168, 170, 171, 185, 159, 172, 181, 160, 184, 170, 169, 184, 169, 63, 173, 168, 182, 179, 170, 174, 172, 165, 169, 162, 177, 191, 63, 178, 168, 63, 173, 175, 174, 181, 165, 170, 170, 178, 171, 162, 180, 172, 177, 160, 176, 178, 176, 173, 168, 179, 175, 171, 169, 177, 166, 165, 175, 162, 138, 180, 164, 140, 157, 170, 150, 155, 180, 163, 62, 155, 161, 172, 165, 156, 179, 157, 174, 171, 173, 192, 178, 174, 175, 171, 178, 170, 154, 187, 172, 168, 172, 166, 178, 165, 177, 168, 185, 173, 156, 172, 174, 184, 162, 179, 168, 183, 176, 61, 178, 174, 62, 169, 179, 187, 175, 168, 171, 168, 183, 175, 168, 182, 174, 62, 161, 168, 193, 164, 170, 174, 184, 183, 169, 176, 179, 183, 168, 180, 171, 174, 168, 164, 173, 174, 174, 176, 174, 176, 179, 61, 172, 174, 179, 180, 168, 194, 184, 179, 178, 162, 179, 164, 61, 169, 181, 174, 177, 172, 182, 172, 168, 179, 169, 190, 169, 171, 173, 163, 190, 162, 173, 174, 178, 176, 173, 178, 174, 172, 62, 192, 172, 174, 178, 163, 183, 167, 175, 179, 175, 174, 168, 172, 189, 167, 62, 175]
for i in range(0, 256):
    if (original_latencies[i] <= threshold):
        print("original latency below at: " + chr(i))
for i in range(0, 256):
    if (hfi_latencies[i] <= threshold):
        print("HFI latency below at: " + chr(i))


plt.figure(figsize=(5,3))
plt.plot(x, original_latencies, color='red')
plt.plot([x+0.5 for x in x], hfi_latencies)
plt.plot(x, [threshold for _ in x], color='black', linewidth=0.1, linestyle='--')

# plt.text(x * (1 + 0.01), y * (1 + 0.01) , i, fontsize=12)

plt.tight_layout()
plt.savefig("spectre-pht-signal.pdf", format="pdf", bbox_inches="tight", pad_inches=0)